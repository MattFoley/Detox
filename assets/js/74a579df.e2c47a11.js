"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1774],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>y});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),m=a,y=c["".concat(l,".").concat(m)]||c[m]||d[m]||o;return n?r.createElement(y,i(i({ref:t},u),{},{components:n})):r.createElement(y,i({ref:t},u))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(67294),a=n(86010);const o={tabItem:"tabItem_Ymn6"};function i(e){let{children:t,hidden:n,className:i}=e;return r.createElement("div",{role:"tabpanel",className:(0,a.Z)(o.tabItem,i),hidden:n},t)}},74866:(e,t,n)=>{n.d(t,{Z:()=>w});var r=n(87462),a=n(67294),o=n(86010),i=n(12466),s=n(16550),l=n(91980),p=n(67392),u=n(50012);function c(e){return function(e){return a.Children.map(e,(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}function d(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??c(n);return function(e){const t=(0,p.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function y(e){let{queryString:t=!1,groupId:n}=e;const r=(0,s.k6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l._X)(o),(0,a.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(r.location.search);t.set(o,e),r.replace({...r.location,search:t.toString()})}),[o,r])]}function h(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,o=d(e),[i,s]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:o}))),[l,p]=y({queryString:n,groupId:r}),[c,h]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,o]=(0,u.Nk)(n);return[r,(0,a.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:r}),g=(()=>{const e=l??c;return m({value:e,tabValues:o})?e:null})();(0,a.useLayoutEffect)((()=>{g&&s(g)}),[g]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);s(e),p(e),h(e)}),[p,h,o]),tabValues:o}}var g=n(72389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function b(e){let{className:t,block:n,selectedValue:s,selectValue:l,tabValues:p}=e;const u=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{const t=e.currentTarget,n=u.indexOf(t),r=p[n].value;r!==s&&(c(t),l(r))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=u.indexOf(e.currentTarget)+1;t=u[n]??u[0];break}case"ArrowLeft":{const n=u.indexOf(e.currentTarget)-1;t=u[n]??u[u.length-1];break}}t?.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t)},p.map((e=>{let{value:t,label:n,attributes:i}=e;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>u.push(e),onKeyDown:m,onClick:d},i,{className:(0,o.Z)("tabs__item",f.tabItem,i?.className,{"tabs__item--active":s===t})}),n??t)})))}function k(e){let{lazy:t,children:n,selectedValue:r}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==r}))))}function v(e){const t=h(e);return a.createElement("div",{className:(0,o.Z)("tabs-container",f.tabList)},a.createElement(b,(0,r.Z)({},e,t)),a.createElement(k,(0,r.Z)({},e,t)))}function w(e){const t=(0,g.Z)();return a.createElement(v,(0,r.Z)({key:String(t)},e))}},13614:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>y,frontMatter:()=>s,metadata:()=>p,toc:()=>c});var r=n(87462),a=(n(67294),n(3905)),o=n(74866),i=n(85162);const s={},l="Using TypeScript",p={unversionedId:"guide/typescript",id:"version-20.x/guide/typescript",title:"Using TypeScript",description:"This guide assumes you are using Detox's default test runner integration with Jest.",source:"@site/versioned_docs/version-20.x/guide/typescript.md",sourceDirName:"guide",slug:"/guide/typescript",permalink:"/Detox/docs/guide/typescript",draft:!1,editUrl:"https://github.com/wix/Detox/edit/master/docs/versioned_docs/version-20.x/guide/typescript.md",tags:[],version:"20.x",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Parallel Test Execution",permalink:"/Detox/docs/guide/parallel-test-execution"},next:{title:"Using Genymotion SaaS",permalink:"/Detox/docs/guide/genymotion-saas"}},u={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setting up Jest with TypeScript",id:"setting-up-jest-with-typescript",level:2},{value:"Writing Detox Tests in TypeScript",id:"writing-detox-tests-in-typescript",level:2},{value:"Conclusion",id:"conclusion",level:2}],d={toc:c},m="wrapper";function y(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"using-typescript"},"Using TypeScript"),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"This guide assumes you are using Detox's default test runner integration with Jest.\nIf you have a custom integration, you need to consult your test runner's documentation\non how to use TypeScript with it.")),(0,a.kt)("p",null,"It is very common among JavaScript developers to use TypeScript in their projects,\nso a question arises: ",(0,a.kt)("strong",{parentName:"p"},"how to use Detox with TypeScript?")," Since Detox by default\nbases on Jest, the question can be rephrased as: ",(0,a.kt)("a",{parentName:"p",href:"https://jestjs.io/docs/getting-started#using-typescript"},"how to use Jest with TypeScript?"),"."),(0,a.kt)("p",null,"Nevertheless, since many people ask about it, we decided to provide a guide on how to use Detox with TypeScript."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A working Detox setup with Jest as your test runner."),(0,a.kt)("li",{parentName:"ul"},"TypeScript installed in your project.")),(0,a.kt)("p",null,"Since React Native 0.71, the default React Native project template comes with TypeScript support out of the box. However, if you have no TypeScript project, now's the time:"),(0,a.kt)(o.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,a.kt)(i.Z,{value:"npm",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install --save-dev typescript\ntsc --init\n"))),(0,a.kt)(i.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add --dev typescript\ntsc --init\n"))),(0,a.kt)(i.Z,{value:"pnpm",label:"pnpm",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"pnpm add --save-dev typescript\ntsc --init\n")))),(0,a.kt)("p",null,"The latter command will generate a default ",(0,a.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," file, so that you can modify it to suit your needs."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"If you get an error like:"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},"command not found: tsc\n")),(0,a.kt)("p",{parentName:"admonition"},"You can try to:"),(0,a.kt)("ol",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"export PATH=$PATH:./node_modules/.bin")," if you are using ",(0,a.kt)("inlineCode",{parentName:"li"},"bash")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"zsh"),"."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"set PATH=%PATH%;./node_modules/.bin")," if you are using Windows Command Prompt."),(0,a.kt)("li",{parentName:"ol"},"run ",(0,a.kt)("inlineCode",{parentName:"li"},"npx tsc --init")," instead of ",(0,a.kt)("inlineCode",{parentName:"li"},"tsc --init"),"."),(0,a.kt)("li",{parentName:"ol"},"or any other solution to run an executable from ",(0,a.kt)("inlineCode",{parentName:"li"},"node_modules/.bin")," directory."))),(0,a.kt)("p",null,"Make sure your TypeScript compiles without errors before proceeding:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"tsc # or tsc --noEmit if you don't want to generate output files\n")),(0,a.kt)("h2",{id:"setting-up-jest-with-typescript"},"Setting up Jest with TypeScript"),(0,a.kt)("p",null,"Jest requires a few extra packages to work seamlessly with TypeScript, so let's install them:"),(0,a.kt)(o.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,a.kt)(i.Z,{value:"npm",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install --save-dev ts-jest @types/jest @types/node\n"))),(0,a.kt)(i.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add --dev ts-jest @types/jest @types/node\n"))),(0,a.kt)(i.Z,{value:"pnpm",label:"pnpm",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"pnpm add --save-dev ts-jest @types/jest @types/node\n")))),(0,a.kt)("p",null,"Your Jest config file at ",(0,a.kt)("inlineCode",{parentName:"p"},"e2e/jest.config.js")," (or wherever you keep your Jest configuration) also needs a couple of tweaks:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"/** @type {import('@jest/types').Config.InitialOptions} */\nmodule.exports = {\n// highlight-next-line\n  preset: 'ts-jest', // (1)\n  rootDir: '..',\n// highlight-next-line\n  testMatch: ['<rootDir>/e2e/**/*.test.ts'], // (2)\n  testTimeout: 120000,\n  maxWorkers: 1,\n  globalSetup: 'detox/runners/jest/globalSetup',\n  globalTeardown: 'detox/runners/jest/globalTeardown',\n  reporters: ['detox/runners/jest/reporter'],\n  testEnvironment: 'detox/runners/jest/testEnvironment',\n  verbose: true,\n};\n")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The ",(0,a.kt)("inlineCode",{parentName:"p"},"preset")," option tells Jest to use ",(0,a.kt)("inlineCode",{parentName:"p"},"ts-jest")," to compile TypeScript files. This is the most important part of the setup.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Make sure you update your ",(0,a.kt)("inlineCode",{parentName:"p"},"testMatch")," to include TypeScript files. Otherwise, you are likely to get an error like this:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},"No tests found, exiting with code 1\nRun with `--passWithNoTests` to exit with code 0\nIn /path/to/your/project\n  60 files checked.\n  testMatch: /path/to/your/project/e2e/**/*.test.js - 0 matches\n  testPathIgnorePatterns: /node_modules/ - 60 matches\n  testRegex:  - 0 matches\nPattern:  - 0 matches\n")))),(0,a.kt)("h2",{id:"writing-detox-tests-in-typescript"},"Writing Detox Tests in TypeScript"),(0,a.kt)("p",null,"With the setup ready, you can now write Detox tests in TypeScript.\nChange file extensions from ",(0,a.kt)("inlineCode",{parentName:"p"},".js")," to ",(0,a.kt)("inlineCode",{parentName:"p"},".ts")," where appropriate, and you\u2019re good to go."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},"// highlight-next-line\nimport { expect } from 'detox';\n\ndescribe('Login Screen', () => {\n it('should login with correct credentials', async () => {\n   const email: string = 'test@example.com';\n   const password: string = 'password123';\n\n   await element(by.id('emailInput')).typeText(email);\n   await element(by.id('passwordInput')).typeText(password);\n   await element(by.id('loginButton')).tap();\n\n   expect(await element(by.id('welcomeMessage'))).toBeVisible();\n });\n});\n")),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Pay attention at the highlighted line above, where we import ",(0,a.kt)("inlineCode",{parentName:"p"},"expect")," from Detox. Unfortunately, there is ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/wix/Detox/issues/2610"},"an unresolved clash")," between Jest's ",(0,a.kt)("inlineCode",{parentName:"p"},"expect")," and Detox's ",(0,a.kt)("inlineCode",{parentName:"p"},"expect")," when using TypeScript. This will be fixed in the future, but for now, you need to import Detox's ",(0,a.kt)("inlineCode",{parentName:"p"},"expect")," explicitly in case you see errors like this:"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},"error TS2339: Property 'toBeVisible' does not exist on type 'JestMatchers<IndexableNativeElement>'.\n"))),(0,a.kt)("h2",{id:"conclusion"},"Conclusion"),(0,a.kt)("p",null,"Using Detox with TypeScript largely boils down to setting up Jest to understand TypeScript. With the power of static typing, your Detox tests can now become more robust, easier to understand, and less error-prone. Happy testing!"))}y.isMDXComponent=!0}}]);